<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Azure::Storage::Queue::QueueService
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../../';
  framesUrl = "../../../frames.html#!Azure/Storage/Queue/QueueService.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../../_index.html">Index (Q)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Azure.html" title="Azure (module)">Azure</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Storage.html" title="Azure::Storage (module)">Storage</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Queue.html" title="Azure::Storage::Queue (module)">Queue</a></span></span>
     &raquo; 
    <span class="title">QueueService</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Azure::Storage::Queue::QueueService
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">StorageService</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">StorageService</li>
          
            <li class="next">Azure::Storage::Queue::QueueService</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/azure/storage/queue/queue_service.rb</dd>
  
</dl>
<div class="clear"></div>








  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clear_messages-instance_method" title="#clear_messages (instance method)">- (Object) <strong>clear_messages</strong>(queue_name, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Public: Clears all messages from the queue.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_message-instance_method" title="#create_message (instance method)">- (Object) <strong>create_message</strong>(queue_name, message_text, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Public: Adds a message to the queue and optionally sets a visibility
timeout for the message.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_queue-instance_method" title="#create_queue (instance method)">- (Object) <strong>create_queue</strong>(queue_name, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Public: Creates a new queue under the storage account.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_message-instance_method" title="#delete_message (instance method)">- (Object) <strong>delete_message</strong>(queue_name, message_id, pop_receipt, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Public: Deletes a specified message from the queue.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_queue-instance_method" title="#delete_queue (instance method)">- (Object) <strong>delete_queue</strong>(queue_name, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Public: Deletes a queue.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_queue_acl-instance_method" title="#get_queue_acl (instance method)">- (Object) <strong>get_queue_acl</strong>(queue_name, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Public: Gets the access control list (ACL) for the queue.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_queue_metadata-instance_method" title="#get_queue_metadata (instance method)">- (Object) <strong>get_queue_metadata</strong>(queue_name, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Public: Returns queue properties, including user-defined metadata.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (QueueService) <strong>initialize</strong>(options = {}) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of QueueService.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#list_messages-instance_method" title="#list_messages (instance method)">- (Object) <strong>list_messages</strong>(queue_name, visibility_timeout, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Public: Retrieves one or more messages from the front of the queue.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#list_queues-instance_method" title="#list_queues (instance method)">- (Object) <strong>list_queues</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Public: Get a list of Queues from the server.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#peek_messages-instance_method" title="#peek_messages (instance method)">- (Object) <strong>peek_messages</strong>(queue_name, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Public: Retrieves one or more messages from the front of the queue, without
changing the message visibility.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_queue_acl-instance_method" title="#set_queue_acl (instance method)">- (Object) <strong>set_queue_acl</strong>(queue_name, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Public: Sets the access control list (ACL) for the queue.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_queue_metadata-instance_method" title="#set_queue_metadata (instance method)">- (Object) <strong>set_queue_metadata</strong>(queue_name, metadata, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Public: Sets user-defined metadata on the queue.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_message-instance_method" title="#update_message (instance method)">- (Object) <strong>update_message</strong>(queue_name, message_id, pop_receipt, message_text, visibility_timeout, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Public: Adds a message to the queue and optionally sets a visibility
timeout for the message.</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Azure::Storage::Queue::QueueService (class)">QueueService</a></span></tt>) <strong>initialize</strong>(options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of QueueService</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34
35</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/azure/storage/queue/queue_service.rb', line 32</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='ivar'>@host</span> <span class='op'>=</span> <span class='ivar'>@client</span><span class='period'>.</span><span class='id identifier rubyid_storage_queue_host'>storage_queue_host</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="clear_messages-instance_method">
  
    - (<tt>Object</tt>) <strong>clear_messages</strong>(queue_name, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Public: Clears all messages from the queue.</p>

<p>If a queue contains a large number of messages, Clear Messages may time out
before all messages have been deleted. In this case the Queue service will 
return status code 500 (Internal Server Error), with the additional error 
code OperationTimedOut. If the operation times out, the client should 
continue to retry Clear Messages until it succeeds, to ensure that all 
messages have been deleted.</p>

<h4 id="label-Attributes">Attributes</h4>
<ul><li>
<p><code>queue_name</code> - String. The name of the queue.</p>
</li><li>
<p><code>options</code>    - Hash. Optional parameters.</p>
</li></ul>

<h4 id="label-Options">Options</h4>

<p>Accepted key/value pairs in options parameter are:</p>
<ul><li>
<p><code>:timeout</code>   - Integer. A timeout in seconds.</p>
</li></ul>

<p>See <a
href="http://msdn.microsoft.com/en-us/library/azure/dd179454">msdn.microsoft.com/en-us/library/azure/dd179454</a></p>

<p>Returns nil on success</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


111
112
113
114
115
116
117</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/azure/storage/queue/queue_service.rb', line 111</span>

<span class='kw'>def</span> <span class='id identifier rubyid_clear_messages'>clear_messages</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timeout</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='id identifier rubyid_messages_uri'>messages_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:delete</span><span class='comma'>,</span> <span class='id identifier rubyid_uri'>uri</span><span class='rparen'>)</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_message-instance_method">
  
    - (<tt>Object</tt>) <strong>create_message</strong>(queue_name, message_text, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Public: Adds a message to the queue and optionally sets a visibility
timeout for the message.</p>

<h4 id="label-Attributes">Attributes</h4>
<ul><li>
<p><code>queue_name</code>   - String. The queue name.</p>
</li><li>
<p><code>message_text</code> - String. The message contents. Note that the
message content must be in a format that may be encoded with UTF-8.</p>
</li><li>
<p><code>options</code>      - Hash. Optional parameters.</p>
</li></ul>

<h4 id="label-Options">Options</h4>

<p>Accepted key/value pairs in options parameter are:</p>
<ul><li>
<p><code>:visibility_timeout</code>     - Integer. Specifies the new
visibility timeout value, in seconds, relative to server  time. The new
value must be larger than or equal to 0, and cannot be larger than 7  days.
The visibility timeout of a message cannot be set to a value later than the
expiry time. :visibility_timeout should be set to a value smaller than the 
time-to-live value. If not specified, the default value is 0.</p>
</li><li>
<p><code>:message_ttl</code>            - Integer. Specifies the time-to-live
interval for the message, in seconds. The maximum  time-to-live allowed is
7 days. If not specified, the default time-to-live is 7 days.</p>
</li><li>
<p><code>:encode</code>                 - Boolean. If set to true, the message
will be base64 encoded.</p>
</li><li>
<p><code>:timeout</code>                - Integer. A timeout in seconds.</p>
</li></ul>

<p>See <a
href="http://msdn.microsoft.com/en-us/library/azure/dd179346">msdn.microsoft.com/en-us/library/azure/dd179346</a></p>

<p>Returns nil on success</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


314
315
316
317
318
319
320
321
322
323
324
325
326
327
328</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/azure/storage/queue/queue_service.rb', line 314</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_message'>create_message</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_message_text'>message_text</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='rbrace'>}</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>visibilitytimeout</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:visibility_timeout</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:visibility_timeout</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>messagettl</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:message_ttl</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:message_ttl</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timeout</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='id identifier rubyid_messages_uri'>messages_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='const'>Serialization</span><span class='period'>.</span><span class='id identifier rubyid_message_to_xml'>message_to_xml</span><span class='lparen'>(</span><span class='id identifier rubyid_message_text'>message_text</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:encode</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:post</span><span class='comma'>,</span> <span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_queue-instance_method">
  
    - (<tt>Object</tt>) <strong>create_queue</strong>(queue_name, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Public: Creates a new queue under the storage account.</p>

<h4 id="label-Attributes">Attributes</h4>
<ul><li>
<p><code>queue_name</code>     - String. The queue name.</p>
</li><li>
<p><code>options</code>        - Hash. Optional parameters.</p>
</li></ul>

<h4 id="label-Options">Options</h4>

<p>Accepted key/value pairs in options parameter are:</p>
<ul><li>
<p><code>:metadata</code>      - Hash. A hash of user defined metadata.</p>
</li><li>
<p><code>:timeout</code>       - Integer. A timeout in seconds.</p>
</li></ul>

<p>See <a
href="http://msdn.microsoft.com/en-us/library/azure/dd179342">msdn.microsoft.com/en-us/library/azure/dd179342</a></p>

<p>Returns nil on success</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


135
136
137
138
139
140
141
142
143
144
145
146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/azure/storage/queue/queue_service.rb', line 135</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_queue'>create_queue</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timeout</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='id identifier rubyid_queue_uri'>queue_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_headers'>headers</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='rbrace'>}</span>
  <span class='const'>Service</span><span class='op'>::</span><span class='const'>StorageService</span><span class='period'>.</span><span class='id identifier rubyid_add_metadata_to_headers'>add_metadata_to_headers</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:metadata</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_headers'>headers</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:metadata</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:put</span><span class='comma'>,</span> <span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_headers'>headers</span><span class='rparen'>)</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_message-instance_method">
  
    - (<tt>Object</tt>) <strong>delete_message</strong>(queue_name, message_id, pop_receipt, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Public: Deletes a specified message from the queue.</p>

<h4 id="label-Attributes">Attributes</h4>
<ul><li>
<p><code>queue_name</code>   - String. The queue name.</p>
</li><li>
<p><code>message_id</code>   - String. The id of the message.</p>
</li><li>
<p><code>pop_receipt</code>  - String. The valid pop receipt value returned
from an earlier call to the Get Messages or  Update Message operation.</p>
</li><li>
<p><code>options</code>      - Hash. Optional parameters.</p>
</li></ul>

<h4 id="label-Options">Options</h4>

<p>Accepted key/value pairs in options parameter are:</p>
<ul><li>
<p><code>:timeout</code>     - Integer. A timeout in seconds.</p>
</li></ul>

<p>See <a
href="http://msdn.microsoft.com/en-us/library/azure/dd179347">msdn.microsoft.com/en-us/library/azure/dd179347</a></p>

<p>Returns nil on success</p>

<p>Remarks:</p>

<p>When a message is successfully deleted, it is immediately marked for
deletion and is no longer accessible to  clients. The message is later
removed from the queue during garbage collection.</p>

<p>After a client retrieves a message with the Get Messages operation, the
client is expected to process and  delete the message. To delete the
message, you must have two items of data returned in the response body of 
the Get Messages operation:</p>
<ul><li>
<p>The message ID, an opaque GUID value that identifies the message in the
queue.</p>
</li><li>
<p>A valid pop receipt, an opaque value that indicates that the message has
been retrieved.</p>
</li></ul>

<p>The message ID is returned from the previous Get Messages operation. The
pop receipt is returned from the most  recent Get Messages or Update
Message operation. In order for the Delete Message operation to succeed,
the pop  receipt specified on the request must match the pop receipt
returned from the Get Messages or Update Message  operation.</p>

<p>Pop receipts remain valid until one of the following events occurs:</p>
<ul><li>
<p>The message has expired.</p>
</li><li>
<p>The message has been deleted using the last pop receipt received either
from Get Messages or Update Message.</p>
</li><li>
<p>The invisibility time has elapsed and the message has been dequeued by a
Get Messages request. When the</p>
</li></ul>

<p>invisibility time elapses, the message becomes visible again. If it is
retrieved by another Get Messages  request, the returned pop receipt can be
used to delete or update the message.</p>
<ul><li>
<p>The message has been updated with a new visibility timeout. When the
message is updated, a new pop receipt</p>
</li></ul>

<p>will be returned.</p>

<p>If the message has already been deleted when Delete Message is called, the
Queue service returns status code  404 (Not Found).</p>

<p>If a message with a matching pop receipt is not found, the service returns
status code 400 (Bad Request), with  additional error information
indicating that the cause of the failure was a mismatched pop receipt.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


386
387
388
389
390
391
392
393
394</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/azure/storage/queue/queue_service.rb', line 386</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_message'>delete_message</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_message_id'>message_id</span><span class='comma'>,</span> <span class='id identifier rubyid_pop_receipt'>pop_receipt</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>popreceipt</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_pop_receipt'>pop_receipt</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timeout</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='id identifier rubyid_message_uri'>message_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_message_id'>message_id</span><span class='comma'>,</span> <span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:delete</span><span class='comma'>,</span> <span class='id identifier rubyid_uri'>uri</span><span class='rparen'>)</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_queue-instance_method">
  
    - (<tt>Object</tt>) <strong>delete_queue</strong>(queue_name, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Public: Deletes a queue.</p>

<h4 id="label-Attributes">Attributes</h4>
<ul><li>
<p><code>queue_name</code>     - String. The queue name.</p>
</li><li>
<p><code>options</code>        - Hash. Optional parameters.</p>
</li></ul>

<h4 id="label-Options">Options</h4>

<p>Accepted key/value pairs in options parameter are:</p>
<ul><li>
<p><code>:timeout</code>       - Integer. A timeout in seconds.</p>
</li></ul>

<p>See <a
href="http://msdn.microsoft.com/en-us/library/azure/dd179436">msdn.microsoft.com/en-us/library/azure/dd179436</a></p>

<p>Returns nil on success</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


163
164
165
166
167
168
169
170
171</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/azure/storage/queue/queue_service.rb', line 163</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_queue'>delete_queue</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timeout</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='id identifier rubyid_queue_uri'>queue_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:delete</span><span class='comma'>,</span> <span class='id identifier rubyid_uri'>uri</span><span class='rparen'>)</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_queue_acl-instance_method">
  
    - (<tt>Object</tt>) <strong>get_queue_acl</strong>(queue_name, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Public: Gets the access control list (ACL) for the queue.</p>

<h4 id="label-Attributes">Attributes</h4>
<ul><li>
<p><code>queue_name</code> - String. The queue name.</p>
</li><li>
<p><code>options</code>    - Hash. Optional parameters.</p>
</li></ul>

<h4 id="label-Options">Options</h4>

<p>Accepted key/value pairs in options parameter are:</p>
<ul><li>
<p><code>:timeout</code>       - Integer. A timeout in seconds.</p>
</li></ul>

<p>See <a
href="http://msdn.microsoft.com/en-us/library/azure/jj159101">msdn.microsoft.com/en-us/library/azure/jj159101</a></p>

<p>Returns a list of Azure::Storage::Entity::SignedIdentifier instances</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


251
252
253
254
255
256
257
258
259
260</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/azure/storage/queue/queue_service.rb', line 251</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_queue_acl'>get_queue_acl</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>comp</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>acl</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timeout</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:get</span><span class='comma'>,</span> <span class='id identifier rubyid_queue_uri'>queue_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_signed_identifiers'>signed_identifiers</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_signed_identifiers'>signed_identifiers</span> <span class='op'>=</span> <span class='const'>Serialization</span><span class='period'>.</span><span class='id identifier rubyid_signed_identifiers_from_xml'>signed_identifiers_from_xml</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span> <span class='op'>==</span> <span class='kw'>nil</span> <span class='kw'>or</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&lt;</span> <span class='int'>1</span>
  <span class='id identifier rubyid_signed_identifiers'>signed_identifiers</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_queue_metadata-instance_method">
  
    - (<tt>Object</tt>) <strong>get_queue_metadata</strong>(queue_name, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Public: Returns queue properties, including user-defined metadata.</p>

<h4 id="label-Attributes">Attributes</h4>
<ul><li>
<p><code>queue_name</code>     - String. The queue name.</p>
</li><li>
<p><code>options</code>        - Hash. Optional parameters.</p>
</li></ul>

<h4 id="label-Options">Options</h4>

<p>Accepted key/value pairs in options parameter are:</p>
<ul><li>
<p><code>:timeout</code>       - Integer. A timeout in seconds.</p>
</li></ul>

<p>See <a
href="http://msdn.microsoft.com/en-us/library/azure/dd179384">msdn.microsoft.com/en-us/library/azure/dd179384</a></p>

<p>Returns a tuple of (approximate_message_count, metadata)</p>
<ul><li>
<p>approximate_messages_count  - Integer. The approximate number of messages
in the queue. This number is not lower than the actual number of messages
in the queue, but could be higher.</p>
</li><li>
<p>metadata                    - Hash. The queue metadata (Default: {})</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


192
193
194
195
196
197
198
199
200
201
202
203
204</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/azure/storage/queue/queue_service.rb', line 192</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_queue_metadata'>get_queue_metadata</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>comp</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>metadata</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timeout</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='id identifier rubyid_queue_uri'>queue_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:get</span><span class='comma'>,</span> <span class='id identifier rubyid_uri'>uri</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_approximate_messages_count'>approximate_messages_count</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>x-ms-approximate-messages-count</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_metadata'>metadata</span> <span class='op'>=</span> <span class='const'>Serialization</span><span class='period'>.</span><span class='id identifier rubyid_metadata_from_headers'>metadata_from_headers</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='rparen'>)</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_approximate_messages_count'>approximate_messages_count</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span> <span class='id identifier rubyid_metadata'>metadata</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="list_messages-instance_method">
  
    - (<tt>Object</tt>) <strong>list_messages</strong>(queue_name, visibility_timeout, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Public: Retrieves one or more messages from the front of the queue.</p>

<h4 id="label-Attributes">Attributes</h4>
<ul><li>
<p><code>queue_name</code>          - String. The queue name.</p>
</li><li>
<p><code>visibility_timeout</code>  - Integer. The new visibility timeout
value, in seconds, relative to server time.</p>
</li><li>
<p><code>options</code>             - Hash. Optional parameters.</p>
</li></ul>

<h4 id="label-Options">Options</h4>

<p>Accepted key/value pairs in options parameter are:</p>
<ul><li>
<p><code>:number_of_messages</code> - Integer. How many messages to return.
(optional, Default: 1)</p>
</li><li>
<p><code>:timeout</code>            - Integer. A timeout in seconds.</p>
</li><li>
<p><code>:decode</code>             - Boolean. Boolean value indicating if the
message should be base64 decoded.</p>
</li></ul>

<p>See <a
href="http://msdn.microsoft.com/en-us/library/azure/dd179474">msdn.microsoft.com/en-us/library/azure/dd179474</a></p>

<p>Returns a list of Azure::Storage::Entity::Queue::Message instances</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


445
446
447
448
449
450
451
452
453
454
455
456
457</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/azure/storage/queue/queue_service.rb', line 445</span>

<span class='kw'>def</span> <span class='id identifier rubyid_list_messages'>list_messages</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_visibility_timeout'>visibility_timeout</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_number_of_messages'>number_of_messages</span><span class='op'>=</span><span class='int'>1</span>
  <span class='id identifier rubyid_number_of_messages'>number_of_messages</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:number_of_messages</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:number_of_messages</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>visibilitytimeout</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_visibility_timeout'>visibility_timeout</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>numofmessages</span><span class='tstring_end'>&quot;</span></span><span class='op'>=&gt;</span> <span class='id identifier rubyid_number_of_messages'>number_of_messages</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timeout</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='id identifier rubyid_messages_uri'>messages_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:get</span><span class='comma'>,</span> <span class='id identifier rubyid_uri'>uri</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_messages'>messages</span> <span class='op'>=</span> <span class='const'>Serialization</span><span class='period'>.</span><span class='id identifier rubyid_queue_messages_from_xml'>queue_messages_from_xml</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:decode</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_messages'>messages</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="list_queues-instance_method">
  
    - (<tt>Object</tt>) <strong>list_queues</strong>(options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Public: Get a list of Queues from the server</p>

<h4 id="label-Attributes">Attributes</h4>
<ul><li>
<p><code>options</code>    - Hash. Optional parameters.</p>
</li></ul>

<h4 id="label-Options">Options</h4>

<p>Accepted key/value pairs in options parameter are:</p>
<ul><li>
<p><code>:prefix</code>      - String. Filters the results to return only
containers  whose name begins with the specified prefix. (optional)</p>
</li><li>
<p><code>:marker</code>      - String. An identifier the specifies the portion
of the  list to be returned. This value comes from the property
Azure::Service::EnumerationResults.continuation_token when there  are more
containers available than were returned. The  marker value may then be used
here to request the next set of list items. (optional)</p>
</li><li>
<p><code>:max_results</code> - Integer. Specifies the maximum number of
containers to return.  If max_results is not specified, or is a value
greater than  5,000, the server will return up to 5,000 items. If it is set
to a value less than or equal to zero, the server will return  status code
400 (Bad Request). (optional)</p>
</li><li>
<p><code>:metadata</code>    - Boolean. Specifies whether or not to return the
container metadata. (optional, Default=false)</p>
</li><li>
<p><code>:timeout</code>     - Integer. A timeout in seconds.</p>
</li></ul>

<p>NOTE: Metadata requested with the :metadata parameter must have been stored
in accordance with the naming restrictions imposed by the 2009-09-19
version of the queue  service. Beginning with that version, all metadata
names must adhere to the naming  conventions for C# identifiers.</p>

<p>See <a
href="http://msdn.microsoft.com/en-us/library/azure/dd179466">msdn.microsoft.com/en-us/library/azure/dd179466</a></p>

<p>Any metadata with invalid names which were previously stored, will be
returned with the  key x-ms-invalid-name in the metadata hash. This may
contain multiple values and be an Array (vs a String if it only contains a
single value).</p>

<p>Returns an Azure::Service::EnumerationResults</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


75
76
77
78
79
80
81
82
83
84
85
86
87</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/azure/storage/queue/queue_service.rb', line 75</span>

<span class='kw'>def</span> <span class='id identifier rubyid_list_queues'>list_queues</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>prefix</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:prefix</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:prefix</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>marker</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:marker</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:marker</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>maxresults</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:max_results</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:max_results</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>include</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>metadata</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:metadata</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timeout</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='id identifier rubyid_collection_uri'>collection_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:get</span><span class='comma'>,</span> <span class='id identifier rubyid_uri'>uri</span><span class='rparen'>)</span>

  <span class='const'>Serialization</span><span class='period'>.</span><span class='id identifier rubyid_queue_enumeration_results_from_xml'>queue_enumeration_results_from_xml</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="peek_messages-instance_method">
  
    - (<tt>Object</tt>) <strong>peek_messages</strong>(queue_name, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Public: Retrieves one or more messages from the front of the queue, without
changing the message visibility.</p>

<h4 id="label-Attributes">Attributes</h4>
<ul><li>
<p><code>queue_name</code>   - String. The queue name.</p>
</li><li>
<p><code>options</code>      - Hash. Optional parameters.</p>
</li></ul>

<h4 id="label-Options">Options</h4>

<p>Accepted key/value pairs in options parameter are:</p>
<ul><li>
<p><code>:number_of_messages</code> - Integer. How many messages to return.
(optional, Default: 1)</p>
</li><li>
<p><code>:decode</code>             - Boolean. Boolean value indicating if the
message should be base64 decoded.</p>
</li><li>
<p><code>:timeout</code>            - Integer. A timeout in seconds.</p>
</li></ul>

<p>See <a
href="http://msdn.microsoft.com/en-us/library/azure/dd179472">msdn.microsoft.com/en-us/library/azure/dd179472</a></p>

<p>Returns a list of Azure::Storage::Entity::Queue::Message instances</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


413
414
415
416
417
418
419
420
421
422
423
424
425</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/azure/storage/queue/queue_service.rb', line 413</span>

<span class='kw'>def</span> <span class='id identifier rubyid_peek_messages'>peek_messages</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_number_of_messages'>number_of_messages</span><span class='op'>=</span><span class='int'>1</span>
  <span class='id identifier rubyid_number_of_messages'>number_of_messages</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:number_of_messages</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:number_of_messages</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>peekonly</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>true</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>numofmessages</span><span class='tstring_end'>&quot;</span></span><span class='op'>=&gt;</span> <span class='id identifier rubyid_number_of_messages'>number_of_messages</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timeout</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='id identifier rubyid_messages_uri'>messages_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:get</span><span class='comma'>,</span> <span class='id identifier rubyid_uri'>uri</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_messages'>messages</span> <span class='op'>=</span> <span class='const'>Serialization</span><span class='period'>.</span><span class='id identifier rubyid_queue_messages_from_xml'>queue_messages_from_xml</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:decode</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_messages'>messages</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_queue_acl-instance_method">
  
    - (<tt>Object</tt>) <strong>set_queue_acl</strong>(queue_name, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Public: Sets the access control list (ACL) for the queue.</p>

<h4 id="label-Attributes">Attributes</h4>
<ul><li>
<p><code>queue_name</code> - String. The queue name.</p>
</li><li>
<p><code>options</code>    - Hash. Optional parameters.</p>
</li></ul>

<h4 id="label-Options">Options</h4>

<p>Accepted key/value pairs in options parameter are:</p>
<ul><li>
<p><code>:signed_identifiers</code>  - Array. A list of
Azure::Storage::Entity::SignedIdentifier instances</p>
</li><li>
<p><code>:timeout</code>             - Integer. A timeout in seconds.</p>
</li></ul>

<p>See <a
href="http://msdn.microsoft.com/en-us/library/azure/jj159099">msdn.microsoft.com/en-us/library/azure/jj159099</a></p>

<p>Returns nil on success</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


278
279
280
281
282
283
284
285
286
287
288</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/azure/storage/queue/queue_service.rb', line 278</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_queue_acl'>set_queue_acl</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>comp</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>acl</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timeout</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span><span class='id identifier rubyid_queue_uri'>queue_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='const'>Serialization</span><span class='period'>.</span><span class='id identifier rubyid_signed_identifiers_to_xml'>signed_identifiers_to_xml</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:signed_identifiers</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:signed_identifiers</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:signed_identifiers</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>

  <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:put</span><span class='comma'>,</span> <span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_queue_metadata-instance_method">
  
    - (<tt>Object</tt>) <strong>set_queue_metadata</strong>(queue_name, metadata, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Public: Sets user-defined metadata on the queue. To delete queue metadata,
call  this API with an empty hash in the metadata parameter.</p>

<h4 id="label-Attributes">Attributes</h4>
<ul><li>
<p><code>queue_name</code> - String. The queue name.</p>
</li><li>
<p><code>metadata</code>   - Hash. A hash of user defined metadata</p>
</li><li>
<p><code>options</code>    - Hash. Optional parameters.</p>
</li></ul>

<h4 id="label-Options">Options</h4>

<p>Accepted key/value pairs in options parameter are:</p>
<ul><li>
<p><code>:timeout</code>       - Integer. A timeout in seconds.</p>
</li></ul>

<p>See <a
href="http://msdn.microsoft.com/en-us/library/azure/dd179348">msdn.microsoft.com/en-us/library/azure/dd179348</a></p>

<p>Returns nil on success</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


223
224
225
226
227
228
229
230
231
232
233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/azure/storage/queue/queue_service.rb', line 223</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_queue_metadata'>set_queue_metadata</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_metadata'>metadata</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>comp</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>metadata</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timeout</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='id identifier rubyid_queue_uri'>queue_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_headers'>headers</span> <span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='const'>Service</span><span class='op'>::</span><span class='const'>StorageService</span><span class='period'>.</span><span class='id identifier rubyid_add_metadata_to_headers'>add_metadata_to_headers</span><span class='lparen'>(</span><span class='id identifier rubyid_metadata'>metadata</span> <span class='op'>||</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_headers'>headers</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:put</span><span class='comma'>,</span> <span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_headers'>headers</span><span class='rparen'>)</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_message-instance_method">
  
    - (<tt>Object</tt>) <strong>update_message</strong>(queue_name, message_id, pop_receipt, message_text, visibility_timeout, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Public: Adds a message to the queue and optionally sets a visibility
timeout for the message.</p>

<h4 id="label-Attributes">Attributes</h4>
<ul><li>
<p><code>queue_name</code>         - String. The queue name.</p>
</li><li>
<p><code>message_id</code>         - String. The id of the message.</p>
</li><li>
<p><code>pop_receipt</code>        - String. The valid pop receipt value
returned from an earlier call to the Get Messages or  update Message
operation.</p>
</li><li>
<p><code>message_text</code>       - String. The message contents. Note that
the message content must be in a format that may  be encoded with UTF-8.</p>
</li><li>
<p><code>visibility_timeout</code> - Integer. The new visibility timeout
value, in seconds, relative to server time.</p>
</li><li>
<p><code>options</code>            - Hash. Optional parameters.</p>
</li></ul>

<h4 id="label-Options">Options</h4>

<p>Accepted key/value pairs in options parameter are:</p>
<ul><li>
<p><code>:encode</code>                 - Boolean. If set to true, the message
will be base64 encoded.</p>
</li><li>
<p><code>:timeout</code>           - Integer. A timeout in seconds.</p>
</li></ul>

<p>See <a
href="http://msdn.microsoft.com/en-us/library/azure/hh452234">msdn.microsoft.com/en-us/library/azure/hh452234</a></p>

<p>Returns a tuple of (pop_receipt, time_next_visible)</p>
<ul><li>
<p>pop_receipt        - String. The pop receipt of the queue message.</p>
</li><li>
<p>time_next_visible  - String. A UTC date/time value that represents when the
message will be visible on the queue.</p>
</li></ul>

<p>Remarks:</p>

<p>An Update Message operation will fail if the specified message does not
exist in the queue, or if the  specified pop receipt does not match the
message.</p>

<p>A pop receipt is returned by the Get Messages operation or the Update
Message operation. Pop receipts  remain valid until one of the following
events occurs:</p>
<ul><li>
<p>The message has expired.</p>
</li><li>
<p>The message has been deleted using the last pop receipt received either
from Get Messages or</p>
</li></ul>

<p>Update Message.</p>
<ul><li>
<p>The invisibility time has elapsed and the message has been dequeued by a
Get Messages request. When</p>
</li></ul>

<p>the invisibility time elapses, the message becomes visible again. If it is
retrieved by another  Get Messages request, the returned pop receipt can be
used to delete or update the message.</p>
<ul><li>
<p>The message has been updated with a new visibility timeout. When the
message is updated, a new pop</p>
</li></ul>

<p>receipt will be returned.</p>

<p>The Update Message operation can be used to continually extend the
invisibility of a queue message. This  functionality can be useful if you
want a worker role to lease a queue message. For example, if a worker 
role calls Get Messages and recognizes that it needs more time to process a
message, it can continually  extend the message&#39;s invisibility until it
is processed. If the worker role were to fail during processing, 
eventually the message would become visible again and another worker role
could process it.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


510
511
512
513
514
515
516
517
518
519
520
521</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/azure/storage/queue/queue_service.rb', line 510</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_message'>update_message</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_message_id'>message_id</span><span class='comma'>,</span> <span class='id identifier rubyid_pop_receipt'>pop_receipt</span><span class='comma'>,</span> <span class='id identifier rubyid_message_text'>message_text</span><span class='comma'>,</span> <span class='id identifier rubyid_visibility_timeout'>visibility_timeout</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>visibilitytimeout</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_visibility_timeout'>visibility_timeout</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>popreceipt</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_pop_receipt'>pop_receipt</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timeout</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='id identifier rubyid_message_uri'>message_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_queue_name'>queue_name</span><span class='comma'>,</span> <span class='id identifier rubyid_message_id'>message_id</span><span class='comma'>,</span> <span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='const'>Serialization</span><span class='period'>.</span><span class='id identifier rubyid_message_to_xml'>message_to_xml</span><span class='lparen'>(</span><span class='id identifier rubyid_message_text'>message_text</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:encode</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:put</span><span class='comma'>,</span> <span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_new_pop_receipt'>new_pop_receipt</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>x-ms-popreceipt</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_time_next_visible'>time_next_visible</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>x-ms-time-next-visible</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_new_pop_receipt'>new_pop_receipt</span><span class='comma'>,</span> <span class='id identifier rubyid_time_next_visible'>time_next_visible</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Sat Mar 19 11:46:05 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.1.7).
</div>

  </body>
</html>